<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>angular2初入眼帘之－了解component | 右领军大都督</title>
    <meta name="description" content="

上一章里我们讲了如何为angular2搭建开发环境(还没搭起来的赶紧去看哦)，并使之跑起来我们的第一个“My First Angular 2 App”。当然也有不少朋友反映环境搭建似乎比较复杂，整整一篇教程，最后只简单输出了一句话！这里我要说一句，学习新知识的确有一个阵痛的过程，尤其像angular2这种框架，引入了大量以前“前端”并不关心(没有需求)的 ...">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.ff698ad4.css" as="style"><link rel="preload" href="/assets/js/app.66fd165c.js" as="script"><link rel="preload" href="/assets/js/6.1b9a181a.js" as="script"><link rel="preload" href="/assets/js/4.718a8abf.js" as="script"><link rel="preload" href="/assets/js/37.766086c8.js" as="script"><link rel="prefetch" href="/assets/js/1.836aefc7.js"><link rel="prefetch" href="/assets/js/10.5978e5d8.js"><link rel="prefetch" href="/assets/js/11.ec890499.js"><link rel="prefetch" href="/assets/js/12.db7bcb86.js"><link rel="prefetch" href="/assets/js/13.a0678d0c.js"><link rel="prefetch" href="/assets/js/14.db66846d.js"><link rel="prefetch" href="/assets/js/15.2591b2da.js"><link rel="prefetch" href="/assets/js/16.80583441.js"><link rel="prefetch" href="/assets/js/17.0753be43.js"><link rel="prefetch" href="/assets/js/18.72780206.js"><link rel="prefetch" href="/assets/js/19.1d487c74.js"><link rel="prefetch" href="/assets/js/20.f0fe9a95.js"><link rel="prefetch" href="/assets/js/21.d80a0f41.js"><link rel="prefetch" href="/assets/js/22.4695553f.js"><link rel="prefetch" href="/assets/js/23.52e4eec9.js"><link rel="prefetch" href="/assets/js/24.bf9c9350.js"><link rel="prefetch" href="/assets/js/25.5eb98d81.js"><link rel="prefetch" href="/assets/js/26.17cf0ede.js"><link rel="prefetch" href="/assets/js/27.522aaf5a.js"><link rel="prefetch" href="/assets/js/28.f0f1746b.js"><link rel="prefetch" href="/assets/js/29.7185f335.js"><link rel="prefetch" href="/assets/js/30.84d20b8c.js"><link rel="prefetch" href="/assets/js/31.c51c0b21.js"><link rel="prefetch" href="/assets/js/32.7d842090.js"><link rel="prefetch" href="/assets/js/33.9948fc6c.js"><link rel="prefetch" href="/assets/js/34.03615f5c.js"><link rel="prefetch" href="/assets/js/35.916ec328.js"><link rel="prefetch" href="/assets/js/36.573317d5.js"><link rel="prefetch" href="/assets/js/38.b2d6547e.js"><link rel="prefetch" href="/assets/js/39.f52d00bf.js"><link rel="prefetch" href="/assets/js/40.fffe6b1e.js"><link rel="prefetch" href="/assets/js/41.d2951850.js"><link rel="prefetch" href="/assets/js/42.1d2dcebb.js"><link rel="prefetch" href="/assets/js/43.8e48cd61.js"><link rel="prefetch" href="/assets/js/44.8303cf21.js"><link rel="prefetch" href="/assets/js/45.39ad8d71.js"><link rel="prefetch" href="/assets/js/5.6e87a095.js"><link rel="prefetch" href="/assets/js/7.01c41c5e.js"><link rel="prefetch" href="/assets/js/8.b9ecde8b.js"><link rel="prefetch" href="/assets/js/9.a3929d94.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.da6e1ebe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ff698ad4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">右领军大都督 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">右领军大都督 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        angular2初入眼帘之－了解component
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Howard Zuo</span> <span itemprop="address">   in Shanghai</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2016-04-14T00:00:00.000Z">
      Thu Apr 14 2016
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-d832e844><a href="/tag/angular" data-v-d832e844> angular </a></li><li class="post-tag" data-v-d832e844><a href="/tag/tutorial" data-v-d832e844> tutorial </a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="前集回顾"><a href="#前集回顾" class="header-anchor">#</a> 前集回顾</h2> <p><a href="http://leftstick.github.io/tech/2016/04/09/angular2-01-env" target="_blank" rel="noopener noreferrer">上一章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里我们讲了如何为<code>angular2</code>搭建开发环境(还没搭起来的赶紧去看哦)，并使之跑起来我们的第一个“My First Angular 2 App”。当然也有不少朋友反映环境搭建似乎比较复杂，整整一篇教程，最后只简单输出了一句话！这里我要说一句，学习新知识的确有一个阵痛的过程，尤其像<code>angular2</code>这种框架，引入了大量以前“前端”并不关心(没有需求)的技术栈，这使得对于之前没有接触过这些概念的朋友的学习曲线陡然飙升，相信不少人看了<a href="http://leftstick.github.io/tech/2016/04/09/angular2-01-env" target="_blank" rel="noopener noreferrer">上一章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里开篇时的那些名词后已经认识到这一点了！本教程主打实际操作，但也不会完全忽略理论，我们边做边理解。今天就接着<a href="http://leftstick.github.io/tech/2016/04/09/angular2-01-env" target="_blank" rel="noopener noreferrer">上一章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的余温，我们来写一个简单<code>component</code>。</p> <p>本章源码：<a href="https://github.com/leftstick/angular2-lesson/tree/master/examples/component" target="_blank" rel="noopener noreferrer">component<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>本章使用<code>angular2</code>版本为：<code>2.0.0-rc.1</code></p> <p>先来看看我们将要完成的效果图：</p> <img src="/images/angular2-02-preview.gif" alt="angular"> <p>(注意动画的部分)非常简单的一个<code>component</code>，有木有？那好，我们现在要做的就是为这样一个<code>component</code>描述需求：</p> <ol><li>她要能接受一个<code>object</code>用来描述初始值，如：<code>isChecked</code>(是否选中)、 <code>txt</code>(显示文本)</li> <li>当选中时，需要有横线覆盖文本；反之亦然</li> <li>当用户点击复选框时，需要向上广播该事件，由父组件(调用方)决定点击时该做什么。这里我们需要在父组件里改变<code>component</code>的<code>isChecked</code>状态，并使<code>component</code>重绘</li> <li>她必须是一个处理<a href="https://medium.com/@AdamRNeary/unidirectional-data-flow-yes-flux-i-am-not-so-sure-b4acf988196c#.bxd6ripaq" target="_blank" rel="noopener noreferrer">Unidirectional Data Flow<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>(单向数据流)的<code>component</code>，意思是传入参数必须<a href="http://leftstick.github.io/tech/2016/04/09/immutability-in-javascript" target="_blank" rel="noopener noreferrer">不可变(Immutable)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <blockquote><p>注：第4步里，我们使用<code>Unidirectional Data Flow</code>模型来更新数据，并没有涉及到任何<a href="https://en.wikipedia.org/wiki/Reactive_programming" target="_blank" rel="noopener noreferrer">Reactive Programming<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的知识点</p></blockquote> <p>为了完成以上需求，我们需要了解下面知识点</p> <h2 id="什么是component"><a href="#什么是component" class="header-anchor">#</a> 什么是<code>component</code></h2> <p>或者这么问，<a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer">AngularJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里有<a href="https://docs.angularjs.org/guide/directive" target="_blank" rel="noopener noreferrer">directive<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>；<a href="https://angular.io/" target="_blank" rel="noopener noreferrer">angular2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里有<code>component</code>，他们是什么关系？该如何理解<a href="https://angular.io/" target="_blank" rel="noopener noreferrer">angular2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里的<code>component</code>？原谅我这里就不再详述<a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer">AngularJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>里的<a href="https://docs.angularjs.org/guide/directive" target="_blank" rel="noopener noreferrer">directive<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>了，直接介绍<code>component</code>：</p> <ol><li><code>Component</code>： 简单说，就是带<code>template</code>的<code>directive</code>，也是最常见的组件形式。譬如：<a href="http://leftstick.github.io/tech/2016/04/09/angular2-01-env" target="_blank" rel="noopener noreferrer">上一章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中，<code>ts/app.ts</code>里的<code>AppComponent</code>。</li> <li><code>Structural directive</code>： 通过增加/删除<code>DOM</code>元素改变<code>DOM</code>布局的<code>directive</code>。譬如：<a href="https://angular.io/docs/ts/latest/guide/template-syntax.html#ng-for" target="_blank" rel="noopener noreferrer">NgFor<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和<a href="https://angular.io/docs/ts/latest/guide/template-syntax.html#ng-if" target="_blank" rel="noopener noreferrer">NgIf<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><code>Attribute directive</code>： 控制<code>DOM</code>元素显示/隐藏，或者改变元素行为的<code>directive</code>。譬如：<a href="https://angular.io/docs/ts/latest/guide/template-syntax.html#ng-style" target="_blank" rel="noopener noreferrer">NgStyle<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="设计use-case"><a href="#设计use-case" class="header-anchor">#</a> 设计use case</h2> <p>看过我之前介绍<a href="http://leftstick.github.io/tech/2016/03/18/write-di-in-bdd" target="_blank" rel="noopener noreferrer">以BDD手写依赖注入(dependency injection)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的朋友应该已经对&quot;行为驱动&quot;多少有些了解了。当我们需要设计一个API或者组件时，最佳的方式就是先设计她的使用场景，从行为开始，对该API或者组件进行描述，最后再将缺失的“实现”部分补全就可以了。</p> <p>假设我们将在<a href="http://leftstick.github.io/tech/2016/04/09/angular2-01-env" target="_blank" rel="noopener noreferrer">上一章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中的<code>AppComponent</code>里使用这个新的<code>component</code>，根据之前的需求描述，我们的使用场景应该是这个样子的 :</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>

<span class="token comment">//这里CheckableItem就是我们即将设计的新component</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CheckableItem<span class="token punctuation">,</span> Item<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./CheckableItem'</span><span class="token punctuation">;</span>

<span class="token comment">//该component使用checkable-item作为selector</span>
<span class="token comment">//并可以通过[item]属性传入一个object</span>
<span class="token comment">//还可以通过(onItemClicked)接受一个点击事件</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'my-app'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;h1&gt;My First Angular 2 App&lt;/h1&gt;
    &lt;checkable-item [item]=&quot;itemInfo&quot; (onItemClicked)=&quot;toggle($event)&quot;&gt;
    &lt;/checkable-item&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">//引入新的CheckableItem，使之可以在AppComponent里使用</span>
    directives<span class="token operator">:</span> <span class="token punctuation">[</span>CheckableItem<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>

    itemInfo<span class="token operator">:</span> Item<span class="token punctuation">;</span>

    <span class="token comment">//当实现OnInit接口时，必须重写ngOnInit方法</span>
    <span class="token comment">//关于OnInit，详见：</span>
    <span class="token comment">//https://angular.io/docs/ts/latest/guide/lifecycle-hooks.html#!#hooks-overview</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//设定初始值</span>
        <span class="token comment">//根据需求第1条，包含两个属性</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
            isChecked<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            txt<span class="token operator">:</span> <span class="token string">'Hello World!'</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//根据需求第3条，点击component后，事件要</span>
    <span class="token comment">//冒泡到父组件(调用方)</span>
    <span class="token function">toggle</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token operator">:</span> Item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//当获取到CheckableItem的点击事件时，</span>
        <span class="token comment">//给itemInfo重新赋值，并将isChecked置反</span>
        <span class="token comment">//注：重新赋值是根据需求第4条的不可变性</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
            isChecked<span class="token operator">:</span> <span class="token operator">!</span>item<span class="token punctuation">.</span>isChecked<span class="token punctuation">,</span>
            txt<span class="token operator">:</span> item<span class="token punctuation">.</span>txt
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>根据上述介绍，再结合之前的效果图，我们要做的当然就是一个标准的<code>Component</code>。她有<code>template</code>，并且包含了至少一个<code>input</code>和一个<code>label</code>标签。</p> <p>有了使用场景(行为)，接下来就是实现这个<code>CheckableItem</code>了：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">touch</span> ts/CheckableItem.ts
</code></pre></div><p>向刚创建的<code>ts/CheckableItem.ts</code>文件里写入如下内容：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> Output<span class="token punctuation">,</span> EventEmitter<span class="token punctuation">,</span> ChangeDetectionStrategy<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//脏检查策略，OnPush指当且仅当传入参数的reference发生变更时</span>
    <span class="token comment">//触发组件重绘。这和React中的shouldComponentUpdate异曲同工，</span>
    <span class="token comment">//不过更先进(因为React还是需要手动实现的)</span>
    <span class="token comment">//这也是上一步里itemInfo必须重新赋值的原因</span>
    changeDetection<span class="token operator">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush<span class="token punctuation">,</span>
    selector<span class="token operator">:</span> <span class="token string">'checkable-item'</span><span class="token punctuation">,</span>
    <span class="token comment">//仅在当前component作用域下有效的class</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .deleted{
            text-decoration: line-through;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//template就如我们需求里的描述那样，由一个input标签和</span>
    <span class="token comment">//一个label标签组成</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;
        &lt;input type=&quot;checkbox&quot; [ngModel]=&quot;item.isChecked&quot; (click)=&quot;clickItem($event)&quot;&gt;
        &lt;label [class.deleted]=&quot;item.isChecked&quot;&gt;{{ item.txt }}&lt;/label&gt;
    &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CheckableItem</span> <span class="token punctuation">{</span>
    <span class="token comment">//item被声明为Input，即会在父组件传入参数时用到</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> item<span class="token operator">:</span> Item<span class="token punctuation">;</span>
    <span class="token comment">//onItemClicked被声明为Output，用来在用户点击input标签</span>
    <span class="token comment">//时向上冒泡事件</span>
    @<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> onItemClicked <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//监听input上的click事件，当用户点击时，首先阻止默认行为</span>
    <span class="token comment">//因为是否变化(重绘)是由父组件决定的</span>
    <span class="token comment">//然后冒泡点击事件</span>
    <span class="token function">clickItem</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> MouseEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>onItemClicked<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ToggleItemHandler</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>item<span class="token operator">:</span> Item<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
    isChecked<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    txt<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有朋友看到这里，对<code>[]</code>、 <code>()</code>之类的绑定标签表示不解，这里我们统一来解释：</p> <ol><li><code>[target] = &quot;expression&quot;</code>，将右边表达式对应的值绑定到左边的<code>target</code>。譬如：在<code>ts/app.ts</code>里，我们使用<code>[item]=&quot;itemInfo&quot;</code>将<code>itemInfo</code>对应的值绑定到了组件<code>CheckableItem</code>的<code>item</code>上，这样，在<code>CheckableItem</code>里就可以通过<code>this.item</code>获取到父组件传进来的参数了。</li> <li><code>(target) = &quot;statement&quot;</code>，将左边的事件传递给了右边的表达式(通常就是事件处理函数)。譬如：在<code>ts/app.ts</code>里，我们使用<code>(onItemClicked)=&quot;toggle($event)&quot;</code>将<code>CheckableItem</code>冒泡上来的<code>onItemClicked</code>事件传递给了<code>toggle</code>函数。</li> <li><code>[class.deleted]=&quot;item.isChecked&quot;</code>，是<code>class</code>的一种特殊用法，指当<code>item.isChecked</code>表达式为真时，为该标签的<code>class</code>里增加<code>deleted</code>；反之，则删除该标签<code>class</code>里的<code>deleted</code></li></ol> <p>OK，事已至此，我们是不是又该启动一把程序看看效果了？</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> start
</code></pre></div><p>你又看到了伟大的效果：</p> <img src="/images/angular2-02-preview.gif" alt="angular"> <p>下回预告：<a href="http://leftstick.github.io/tech/2016/04/14/angular2-03-multicomponents" target="_blank" rel="noopener noreferrer">小刀升级 － 多<code>component</code>协作<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#前集回顾" title="前集回顾">前集回顾</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#什么是component" title="什么是component">什么是component</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#设计use-case" title="设计use case">设计use case</a></div></div></div></div> <footer class="footer" data-v-fdbf4940><div class="footer-left-wrap" data-v-fdbf4940><ul class="contact" data-v-fdbf4940></ul></div> <div class="footer-right-wrap" data-v-fdbf4940><ul class="copyright" data-v-fdbf4940></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.66fd165c.js" defer></script><script src="/assets/js/6.1b9a181a.js" defer></script><script src="/assets/js/4.718a8abf.js" defer></script><script src="/assets/js/37.766086c8.js" defer></script>
  </body>
</html>
