---
layout: post
title: "angular2初入眼帘之－搭个环境"
description: ""
category: "tech"
tags: ["angular2", "tutorial"]
shortContent: "<a href=\"https://angular.io/\">angular2</a>是什么？我猜不容我赘述，各位一定略有耳闻，无论是曾经<a href=\"https://angularjs.org/\">AngularJS</a>的拥趸，抑或是<a href=\"https://facebook.github.io/react/\">React</a>的粉丝，都或多或少的对她有过一点了解。未见其物、先闻其声，<a href=\"https://angular.io/\">angular2</a>在问世之前已经做足了宣传，那想必诸位也一定被下面各种词汇所震慑，什么：<a href=\"http://www.typescriptlang.org/\">TypeScript</a>、<a href=\"http://www.ecma-international.org/ecma-262/5.1/\">ES5</a>、<a href=\"http://www.ecma-international.org/ecma-262/6.0/\">ES6</a>、<a href=\"https://www.dartlang.org/\">Dart</a>、<a href=\"https://en.wikipedia.org/wiki/Immutable_object\">Immutable</a>、<a href=\"https://medium.com/@AdamRNeary/unidirectional-data-flow-yes-flux-i-am-not-so-sure-b4acf988196c#.bxd6ripaq\">Unidirectional Data Flow</a>、<a href=\"https://en.wikipedia.org/wiki/Reactive_programming\">Reactive Programming</a>、<a href=\"https://en.wikipedia.org/wiki/Decorator_pattern\">Decorators</a>、<a href=\"https://github.com/systemjs/systemjs\">System.js</a>、<a href=\"http://webpack.github.io/\">webpack</a>...，天花乱坠，美不胜收！但我们不禁要问，“都说<a href=\"https://angularjs.org/\">AngularJS</a>学习曲线陡峭，也没陡出这些个莫名词汇！”，<a href=\"https://angular.io/\">angular2</a>究竟该如何上手？看了这些个知识点，有木有吓得手抖，都搞不清从何处入手了！？"
---
{% include JB/setup %}

[angular2](https://angular.io/)是什么？我猜不容我赘述，各位一定略有耳闻，无论是曾经[AngularJS](https://angularjs.org/)的拥趸，抑或是[React](https://facebook.github.io/react/)的粉丝，都或多或少的对她有过一点了解。未见其物、先闻其声，[angular2](https://angular.io/)在问世之前已经做足了宣传，想必诸位也一定被下面各种词汇所震慑，什么：[TypeScript](http://www.typescriptlang.org/)、[ES5](http://www.ecma-international.org/ecma-262/5.1/)、[ES6](http://www.ecma-international.org/ecma-262/6.0/)、[Dart](https://www.dartlang.org/)、[Immutable](https://en.wikipedia.org/wiki/Immutable_object)、[Unidirectional Data Flow](https://medium.com/@AdamRNeary/unidirectional-data-flow-yes-flux-i-am-not-so-sure-b4acf988196c#.bxd6ripaq)、[Reactive Programming](https://en.wikipedia.org/wiki/Reactive_programming)、[Decorators](https://en.wikipedia.org/wiki/Decorator_pattern)、[System.js](https://github.com/systemjs/systemjs)、[webpack](http://webpack.github.io/)...，天花乱坠，美不胜收！但我们不禁要问，“都说[AngularJS](https://angularjs.org/)学习曲线陡峭，也没陡出这些个莫名词汇！”，[angular2](https://angular.io/)究竟该如何上手？看了这些个知识点，有木有吓得手抖，都搞不清从何处入手了！？

本教程主旨：多些操作、少点说教(其实理论必须先行，谁让我懒\|\_\|)，让我们从实践中追寻真理吧！

本章源码：[environment](https://github.com/leftstick/angular2-lesson/tree/master/examples/environment)

## 推荐开发工具 ##

### Atom ###

这里我推荐使用[Atom](https://atom.io/)，以及她的`TypeScript`插件[atom-typescript](https://atom.io/packages/atom-typescript)。很爽的哦！

## 创建项目 ##

```shell
mkdir environment
cd environment
npm init
```

根据`npm init`提问，创建`package.json`文件，创建后去掉不必要的字段，像这样即可：

```json
{
  "name": "environment",
  "version": "1.0.0",
  "description": "I will show you how to set up angular2 development environment",
  "keywords": [
    "angular2",
    "environment"
  ],
  "author": "Howard.Zuo",
  "license": "MIT"
}
```

## 安装运行时依赖 ##

```shell
npm install --save --save-exact angular2 es6-shim reflect-metadata@0.1.2 rxjs@5.0.0-beta.2 zone.js
```

* [angular2](https://angular.io/): 这个必须的，没意见吧？
* [es6-shim](https://github.com/paulmillr/es6-shim): `angular2`依赖了大量`ES2015`的特性，这可能导致一些不支持`ES2015`特性的浏览器无法运行`angular2`程序(例如：老版本IE)。所以需要该`shim`来保证老浏览器的正确性
* [reflect-metadata](https://github.com/rbuckton/ReflectDecorators): `angular2`允许开发者使用`Decorator`，这使得程序具备更好的可读性。无奈`Decorator`是`ES2016`里的提案，需要`reflect-metadata`提供反射API才能使用
* [rxjs](https://github.com/ReactiveX/rxjs): 一个`Reactive Programming`的`JavaScript`实现。这里对她的依赖是因为`angular2`支持多种数据更新模式，比如：[flux](https://facebook.github.io/flux/)、[Rx.js](https://github.com/ReactiveX/rxjs)
* [zone.js](https://github.com/angular/zone.js/): 用来对异步任务提供`Hooks`支持，使得在异步任务运行之前/之后做额外操作成为可能。


## 安装开发环境依赖 ##

```shell
npm install --save-dev webpack ts-loader typescript lite-server concurrently
```

* [webpack](http://webpack.github.io/): 我们这里使用`webpack`对源码进行编译、打包，而不是用官网介绍的`System.js`的运行时加载、解释、执行。合并打包的好处不用我多说吧？减少请求数、`uglify`、预检查...
* [ts-loader](https://github.com/TypeStrong/ts-loader): `TypeStrong`出品的`TypeScript`加载器，通过该加载器，`TypeScript`源码可以顺利被编译成`ES5`代码
* [typescript](http://www.typescriptlang.org/): `angular2`官方推荐的开发语言，我们在教程里也将使用该语言进行代码编写
* [lite-server](https://github.com/johnpapa/lite-server): 一个轻量级的静态服务器，本章节我们就用它启动程序
* [concurrently](https://github.com/kimmobrunfeldt/concurrently): 这是一个可以让多个阻塞命令同时执行、管理的工具。我们将在后面用到

## 第一个示例 ##

### 创建`index.html` ###

```shell
touch index.html
```

向刚才创建的`index.html`里添加如下内容：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>environment</title>
</head>
<body>
    <!--这里引用我们的第一个component-->
    <my-app></my-app>
    <!--加载使用webpack编译后的bundle-->
    <script type="text/javascript" src="/dist/bundle.js"></script>
</body>
</html>
```

### 创建`app.ts` ###

```shell
mkdir ts
touch ts/app.ts
```

向刚才创建的`ts/app.ts`里添加如下内容：

```javascript
import {Component} from 'angular2/core';

//声明第一个component
@Component({
    selector: 'my-app',
    template: '<h1>My First Angular 2 App</h1>'
})
export class AppComponent { }
```


### 创建`index.ts` ###

```shell
touch ts/index.ts
```

向刚才创建的`ts/index.ts`里添加如下内容：

```javascript
/// <reference path="../node_modules/angular2/typings/browser.d.ts"/>

import 'es6-shim';
import 'angular2/bundles/angular2-polyfills';

import {bootstrap} from 'angular2/platform/browser';

import {AppComponent} from './app';

//启动程序
bootstrap(AppComponent);
```

### 创建`webpack.config.js` ###

```shell
touch webpack.config.js
```

向刚才创建的`webpack.config.js`里添加如下内容：

```javascript
'use strict';

var path = require('path');

module.exports = {
    entry: {
        index: './ts/index.ts'
    },
    output: {
        path: path.resolve(__dirname, 'dist'),
        filename: 'bundle.js',
        publicPath: 'dist/'
    },
    module: {
        loaders: [
            {
                test: /\.ts$/,
                loader: 'ts'
            }
        ]
    },
    resolve: {
        extensions: [
            '',
            '.js',
            '.ts'
        ]
    }
};
```


### 创建`tsconfig.json` ###

```shell
touch tsconfig.json
```

向刚才创建的`tsconfig.json`里添加如下内容：

```json
{
    "compilerOptions": {
        "noImplicitAny": true,
        "removeComments": true,
        "module": "commonjs",
        "target": "es5",
        "moduleResolution": "node",
        "emitDecoratorMetadata": true,
        "experimentalDecorators": true,
        "sourceMap": true,
        "declaration": false
    },
    "buildOnSave": false,
    "compileOnSave": false,
    "exclude": [
        "node_modules"
    ],
    "atom": {
        "rewriteTsconfig": true,
        "formatOnSave": true
    }
}
```

### 为`package.json`增加常用命令 ###

向`package.json`中，增加`scripts`属性，内容如下：

```json
"scripts": {
  "watch": "webpack -w",
  "start": "concurrently \"npm run watch\" \"lite-server\""
}
```

## 运行 ##

好了，到目前为止，我们第一个示例的开发/运行环境就基本搭好了，现在启动试试看：

```shell
npm run start
```

你会看到：

![]({{ BASE_PATH }}/assets/images/angular2-01.png)
